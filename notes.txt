Example Caddyfile for Staging

{
    email admin@example.com
    acme_dns cloudflare {env.CLOUDFLARE_API_TOKEN}
    acme_ca https://acme-staging-v02.api.letsencrypt.org/directory
    debug
}

# Wildcard for all subdomains
*.example.com {
    reverse_proxy backend:8080
    encode gzip
    log {
        output file /logs/access.log
        format json
    }
}

example.com {
    reverse_proxy backend:8080
    encode gzip
    log {
        output file /logs/access.log
        format json
    }
}


Fallback

{
    email you@example.com
    acme_ca https://acme-staging-v02.api.letsencrypt.org/directory
}

auth.domain.com {
    reverse_proxy http://keycloak:8080
}

https://domain.com {
    tls {
        dns cloudflare {env.CLOUDFLARE_API_TOKEN}
    }

    reverse_proxy /guacamole guacamole:8080

    log {
        output stdout
        format console
        level INFO
    }
}
